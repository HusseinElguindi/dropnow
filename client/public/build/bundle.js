var app=function(){"use strict";function t(){}function e(t){return t()}function n(){return Object.create(null)}function o(t){t.forEach(e)}function i(t){return"function"==typeof t}function r(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function a(t,e){t.appendChild(e)}function s(t,e,n){t.insertBefore(e,n||null)}function c(t){t.parentNode.removeChild(t)}function l(t){return document.createElement(t)}function h(t){return document.createTextNode(t)}function p(){return h(" ")}function u(t,e,n,o){return t.addEventListener(e,n,o),()=>t.removeEventListener(e,n,o)}function f(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function d(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function g(t,e){t.value=null==e?"":e}function m(t,e,n){t.classList[n?"add":"remove"](e)}let w;function v(t){w=t}function y(t,e){const n=t.$$.callbacks[e.type];n&&n.slice().forEach((t=>t.call(this,e)))}const b=[],$=[],_=[],x=[],k=Promise.resolve();let E=!1;function C(t){_.push(t)}function R(t){x.push(t)}let L=!1;const U=new Set;function S(){if(!L){L=!0;do{for(let t=0;t<b.length;t+=1){const e=b[t];v(e),T(e.$$)}for(v(null),b.length=0;$.length;)$.pop()();for(let t=0;t<_.length;t+=1){const e=_[t];U.has(e)||(U.add(e),e())}_.length=0}while(b.length);for(;x.length;)x.pop()();E=!1,L=!1,U.clear()}}function T(t){if(null!==t.fragment){t.update(),o(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(C)}}const O=new Set;let A;function P(t,e){t&&t.i&&(O.delete(t),t.i(e))}function j(t,e,n,o){if(t&&t.o){if(O.has(t))return;O.add(t),A.c.push((()=>{O.delete(t),o&&(n&&t.d(1),o())})),t.o(e)}}function N(t,e,n){const o=t.$$.props[e];void 0!==o&&(t.$$.bound[o]=n,n(t.$$.ctx[o]))}function D(t){t&&t.c()}function I(t,n,r,a){const{fragment:s,on_mount:c,on_destroy:l,after_update:h}=t.$$;s&&s.m(n,r),a||C((()=>{const n=c.map(e).filter(i);l?l.push(...n):o(n),t.$$.on_mount=[]})),h.forEach(C)}function B(t,e){const n=t.$$;null!==n.fragment&&(o(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function H(t,e){-1===t.$$.dirty[0]&&(b.push(t),E||(E=!0,k.then(S)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function q(e,i,r,a,s,l,h,p=[-1]){const u=w;v(e);const f=e.$$={fragment:null,ctx:null,props:l,update:t,not_equal:s,bound:n(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(i.context||(u?u.$$.context:[])),callbacks:n(),dirty:p,skip_bound:!1,root:i.target||u.$$.root};h&&h(f.root);let d=!1;if(f.ctx=r?r(e,i.props||{},((t,n,...o)=>{const i=o.length?o[0]:n;return f.ctx&&s(f.ctx[t],f.ctx[t]=i)&&(!f.skip_bound&&f.bound[t]&&f.bound[t](i),d&&H(e,t)),n})):[],f.update(),d=!0,o(f.before_update),f.fragment=!!a&&a(f.ctx),i.target){if(i.hydrate){const t=function(t){return Array.from(t.childNodes)}(i.target);f.fragment&&f.fragment.l(t),t.forEach(c)}else f.fragment&&f.fragment.c();i.intro&&P(e.$$.fragment),I(e,i.target,i.anchor,i.customElement),S()}v(u)}class z{$destroy(){B(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;var G,K,M=(G=function(t,e){t.exports=function(){var t=Array.isArray||function(t){return"[object Array]"==Object.prototype.toString.call(t)},e=v,n=s,o=c,i=l,r=w,a=new RegExp(["(\\\\.)","([\\/.])?(?:(?:\\:(\\w+)(?:\\(((?:\\\\.|[^()])+)\\))?|\\(((?:\\\\.|[^()])+)\\))([+*?])?|(\\*))"].join("|"),"g");function s(t){for(var e,n=[],o=0,i=0,r="";null!=(e=a.exec(t));){var s=e[0],c=e[1],l=e.index;if(r+=t.slice(i,l),i=l+s.length,c)r+=c[1];else{r&&(n.push(r),r="");var h=e[2],u=e[3],f=e[4],d=e[5],g=e[6],m=e[7],w="+"===g||"*"===g,v="?"===g||"*"===g,y=h||"/",b=f||d||(m?".*":"[^"+y+"]+?");n.push({name:u||o++,prefix:h||"",delimiter:y,optional:v,repeat:w,pattern:p(b)})}}return i<t.length&&(r+=t.substr(i)),r&&n.push(r),n}function c(t){return l(s(t))}function l(e){for(var n=new Array(e.length),o=0;o<e.length;o++)"object"==typeof e[o]&&(n[o]=new RegExp("^"+e[o].pattern+"$"));return function(o){for(var i="",r=o||{},a=0;a<e.length;a++){var s=e[a];if("string"!=typeof s){var c,l=r[s.name];if(null==l){if(s.optional)continue;throw new TypeError('Expected "'+s.name+'" to be defined')}if(t(l)){if(!s.repeat)throw new TypeError('Expected "'+s.name+'" to not repeat, but received "'+l+'"');if(0===l.length){if(s.optional)continue;throw new TypeError('Expected "'+s.name+'" to not be empty')}for(var h=0;h<l.length;h++){if(c=encodeURIComponent(l[h]),!n[a].test(c))throw new TypeError('Expected all "'+s.name+'" to match "'+s.pattern+'", but received "'+c+'"');i+=(0===h?s.prefix:s.delimiter)+c}}else{if(c=encodeURIComponent(l),!n[a].test(c))throw new TypeError('Expected "'+s.name+'" to match "'+s.pattern+'", but received "'+c+'"');i+=s.prefix+c}}else i+=s}return i}}function h(t){return t.replace(/([.+*?=^!:${}()[\]|\/])/g,"\\$1")}function p(t){return t.replace(/([=!:$\/()])/g,"\\$1")}function u(t,e){return t.keys=e,t}function f(t){return t.sensitive?"":"i"}function d(t,e){var n=t.source.match(/\((?!\?)/g);if(n)for(var o=0;o<n.length;o++)e.push({name:o,prefix:null,delimiter:null,optional:!1,repeat:!1,pattern:null});return u(t,e)}function g(t,e,n){for(var o=[],i=0;i<t.length;i++)o.push(v(t[i],e,n).source);return u(new RegExp("(?:"+o.join("|")+")",f(n)),e)}function m(t,e,n){for(var o=s(t),i=w(o,n),r=0;r<o.length;r++)"string"!=typeof o[r]&&e.push(o[r]);return u(i,e)}function w(t,e){for(var n=(e=e||{}).strict,o=!1!==e.end,i="",r=t[t.length-1],a="string"==typeof r&&/\/$/.test(r),s=0;s<t.length;s++){var c=t[s];if("string"==typeof c)i+=h(c);else{var l=h(c.prefix),p=c.pattern;c.repeat&&(p+="(?:"+l+p+")*"),i+=p=c.optional?l?"(?:"+l+"("+p+"))?":"("+p+")?":l+"("+p+")"}}return n||(i=(a?i.slice(0,-2):i)+"(?:\\/(?=$))?"),i+=o?"$":n&&a?"":"(?=\\/|$)",new RegExp("^"+i,f(e))}function v(e,n,o){return t(n=n||[])?o||(o={}):(o=n,n=[]),e instanceof RegExp?d(e,n):t(e)?g(e,n,o):m(e,n,o)}e.parse=n,e.compile=o,e.tokensToFunction=i,e.tokensToRegExp=r;var y,b="undefined"!=typeof document,$="undefined"!=typeof window,_="undefined"!=typeof history,x="undefined"!=typeof process,k=b&&document.ontouchstart?"touchstart":"click",E=$&&!(!window.history.location&&!window.location);function C(){this.callbacks=[],this.exits=[],this.current="",this.len=0,this._decodeURLComponents=!0,this._base="",this._strict=!1,this._running=!1,this._hashbang=!1,this.clickHandler=this.clickHandler.bind(this),this._onpopstate=this._onpopstate.bind(this)}function R(){var t=new C;function e(){return L.apply(t,arguments)}return e.callbacks=t.callbacks,e.exits=t.exits,e.base=t.base.bind(t),e.strict=t.strict.bind(t),e.start=t.start.bind(t),e.stop=t.stop.bind(t),e.show=t.show.bind(t),e.back=t.back.bind(t),e.redirect=t.redirect.bind(t),e.replace=t.replace.bind(t),e.dispatch=t.dispatch.bind(t),e.exit=t.exit.bind(t),e.configure=t.configure.bind(t),e.sameOrigin=t.sameOrigin.bind(t),e.clickHandler=t.clickHandler.bind(t),e.create=R,Object.defineProperty(e,"len",{get:function(){return t.len},set:function(e){t.len=e}}),Object.defineProperty(e,"current",{get:function(){return t.current},set:function(e){t.current=e}}),e.Context=T,e.Route=O,e}function L(t,e){if("function"==typeof t)return L.call(this,"*",t);if("function"==typeof e)for(var n=new O(t,null,this),o=1;o<arguments.length;++o)this.callbacks.push(n.middleware(arguments[o]));else"string"==typeof t?this["string"==typeof e?"redirect":"show"](t,e):this.start(t)}function U(t){if(!t.handled){var e=this,n=e._window;(e._hashbang?E&&this._getBase()+n.location.hash.replace("#!",""):E&&n.location.pathname+n.location.search)!==t.canonicalPath&&(e.stop(),t.handled=!1,E&&(n.location.href=t.canonicalPath))}}function S(t){return t.replace(/([.+*?=^!:${}()[\]|/\\])/g,"\\$1")}function T(t,e,n){var o=this.page=n||L,i=o._window,r=o._hashbang,a=o._getBase();"/"===t[0]&&0!==t.indexOf(a)&&(t=a+(r?"#!":"")+t);var s=t.indexOf("?");this.canonicalPath=t;var c=new RegExp("^"+S(a));if(this.path=t.replace(c,"")||"/",r&&(this.path=this.path.replace("#!","")||"/"),this.title=b&&i.document.title,this.state=e||{},this.state.path=t,this.querystring=~s?o._decodeURLEncodedURIComponent(t.slice(s+1)):"",this.pathname=o._decodeURLEncodedURIComponent(~s?t.slice(0,s):t),this.params={},this.hash="",!r){if(!~this.path.indexOf("#"))return;var l=this.path.split("#");this.path=this.pathname=l[0],this.hash=o._decodeURLEncodedURIComponent(l[1])||"",this.querystring=this.querystring.split("#")[0]}}function O(t,n,o){var i=this.page=o||A,r=n||{};r.strict=r.strict||i._strict,this.path="*"===t?"(.*)":t,this.method="GET",this.regexp=e(this.path,this.keys=[],r)}C.prototype.configure=function(t){var e=t||{};this._window=e.window||$&&window,this._decodeURLComponents=!1!==e.decodeURLComponents,this._popstate=!1!==e.popstate&&$,this._click=!1!==e.click&&b,this._hashbang=!!e.hashbang;var n=this._window;this._popstate?n.addEventListener("popstate",this._onpopstate,!1):$&&n.removeEventListener("popstate",this._onpopstate,!1),this._click?n.document.addEventListener(k,this.clickHandler,!1):b&&n.document.removeEventListener(k,this.clickHandler,!1),this._hashbang&&$&&!_?n.addEventListener("hashchange",this._onpopstate,!1):$&&n.removeEventListener("hashchange",this._onpopstate,!1)},C.prototype.base=function(t){if(0===arguments.length)return this._base;this._base=t},C.prototype._getBase=function(){var t=this._base;if(t)return t;var e=$&&this._window&&this._window.location;return $&&this._hashbang&&e&&"file:"===e.protocol&&(t=e.pathname),t},C.prototype.strict=function(t){if(0===arguments.length)return this._strict;this._strict=t},C.prototype.start=function(t){var e=t||{};if(this.configure(e),!1!==e.dispatch){var n;if(this._running=!0,E){var o=this._window.location;n=this._hashbang&&~o.hash.indexOf("#!")?o.hash.substr(2)+o.search:this._hashbang?o.search+o.hash:o.pathname+o.search+o.hash}this.replace(n,null,!0,e.dispatch)}},C.prototype.stop=function(){if(this._running){this.current="",this.len=0,this._running=!1;var t=this._window;this._click&&t.document.removeEventListener(k,this.clickHandler,!1),$&&t.removeEventListener("popstate",this._onpopstate,!1),$&&t.removeEventListener("hashchange",this._onpopstate,!1)}},C.prototype.show=function(t,e,n,o){var i=new T(t,e,this),r=this.prevContext;return this.prevContext=i,this.current=i.path,!1!==n&&this.dispatch(i,r),!1!==i.handled&&!1!==o&&i.pushState(),i},C.prototype.back=function(t,e){var n=this;if(this.len>0){var o=this._window;_&&o.history.back(),this.len--}else t?setTimeout((function(){n.show(t,e)})):setTimeout((function(){n.show(n._getBase(),e)}))},C.prototype.redirect=function(t,e){var n=this;"string"==typeof t&&"string"==typeof e&&L.call(this,t,(function(t){setTimeout((function(){n.replace(e)}),0)})),"string"==typeof t&&void 0===e&&setTimeout((function(){n.replace(t)}),0)},C.prototype.replace=function(t,e,n,o){var i=new T(t,e,this),r=this.prevContext;return this.prevContext=i,this.current=i.path,i.init=n,i.save(),!1!==o&&this.dispatch(i,r),i},C.prototype.dispatch=function(t,e){var n=0,o=0,i=this;function r(){var t=i.exits[o++];if(!t)return a();t(e,r)}function a(){var e=i.callbacks[n++];if(t.path===i.current)return e?void e(t,a):U.call(i,t);t.handled=!1}e?r():a()},C.prototype.exit=function(t,e){if("function"==typeof t)return this.exit("*",t);for(var n=new O(t,null,this),o=1;o<arguments.length;++o)this.exits.push(n.middleware(arguments[o]))},C.prototype.clickHandler=function(t){if(1===this._which(t)&&!(t.metaKey||t.ctrlKey||t.shiftKey||t.defaultPrevented)){var e=t.target,n=t.path||(t.composedPath?t.composedPath():null);if(n)for(var o=0;o<n.length;o++)if(n[o].nodeName&&"A"===n[o].nodeName.toUpperCase()&&n[o].href){e=n[o];break}for(;e&&"A"!==e.nodeName.toUpperCase();)e=e.parentNode;if(e&&"A"===e.nodeName.toUpperCase()){var i="object"==typeof e.href&&"SVGAnimatedString"===e.href.constructor.name;if(!e.hasAttribute("download")&&"external"!==e.getAttribute("rel")){var r=e.getAttribute("href");if((this._hashbang||!this._samePath(e)||!e.hash&&"#"!==r)&&!(r&&r.indexOf("mailto:")>-1)&&!(i?e.target.baseVal:e.target)&&(i||this.sameOrigin(e.href))){var a=i?e.href.baseVal:e.pathname+e.search+(e.hash||"");a="/"!==a[0]?"/"+a:a,x&&a.match(/^\/[a-zA-Z]:\//)&&(a=a.replace(/^\/[a-zA-Z]:\//,"/"));var s=a,c=this._getBase();0===a.indexOf(c)&&(a=a.substr(c.length)),this._hashbang&&(a=a.replace("#!","")),(!c||s!==a||E&&"file:"===this._window.location.protocol)&&(t.preventDefault(),this.show(s))}}}}},C.prototype._onpopstate=(y=!1,$?(b&&"complete"===document.readyState?y=!0:window.addEventListener("load",(function(){setTimeout((function(){y=!0}),0)})),function(t){if(y){var e=this;if(t.state){var n=t.state.path;e.replace(n,t.state)}else if(E){var o=e._window.location;e.show(o.pathname+o.search+o.hash,void 0,void 0,!1)}}}):function(){}),C.prototype._which=function(t){return null==(t=t||$&&this._window.event).which?t.button:t.which},C.prototype._toURL=function(t){var e=this._window;if("function"==typeof URL&&E)return new URL(t,e.location.toString());if(b){var n=e.document.createElement("a");return n.href=t,n}},C.prototype.sameOrigin=function(t){if(!t||!E)return!1;var e=this._toURL(t),n=this._window.location;return n.protocol===e.protocol&&n.hostname===e.hostname&&(n.port===e.port||""===n.port&&(80==e.port||443==e.port))},C.prototype._samePath=function(t){if(!E)return!1;var e=this._window.location;return t.pathname===e.pathname&&t.search===e.search},C.prototype._decodeURLEncodedURIComponent=function(t){return"string"!=typeof t?t:this._decodeURLComponents?decodeURIComponent(t.replace(/\+/g," ")):t},T.prototype.pushState=function(){var t=this.page,e=t._window,n=t._hashbang;t.len++,_&&e.history.pushState(this.state,this.title,n&&"/"!==this.path?"#!"+this.path:this.canonicalPath)},T.prototype.save=function(){var t=this.page;_&&t._window.history.replaceState(this.state,this.title,t._hashbang&&"/"!==this.path?"#!"+this.path:this.canonicalPath)},O.prototype.middleware=function(t){var e=this;return function(n,o){if(e.match(n.path,n.params))return n.routePath=e.path,t(n,o);o()}},O.prototype.match=function(t,e){var n=this.keys,o=t.indexOf("?"),i=~o?t.slice(0,o):t,r=this.regexp.exec(decodeURIComponent(i));if(!r)return!1;delete e[0];for(var a=1,s=r.length;a<s;++a){var c=n[a-1],l=this.page._decodeURLEncodedURIComponent(r[a]);void 0===l&&hasOwnProperty.call(e,c.name)||(e[c.name]=l)}return!0};var A=R(),P=A,j=A;return P.default=j,P}()},G(K={exports:{}},K.exports),K.exports);function V(e){let n,i,r,h,d,w,v;return{c(){n=l("main"),i=l("input"),r=p(),h=l("div"),d=l("div"),d.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-right svelte-uoaktl"><line x1="5" y1="12" x2="19" y2="12"></line><polyline points="12 5 19 12 12 19"></polyline></svg>',f(i,"placeholder",e[1]),f(i,"spellcheck","false"),f(i,"class","svelte-uoaktl"),f(d,"class","input-btn svelte-uoaktl"),f(h,"class","btn-wrapper svelte-uoaktl"),f(n,"class","wrapper svelte-uoaktl"),m(n,"focused",e[2])},m(t,o){s(t,n,o),a(n,i),g(i,e[0]),a(n,r),a(n,h),a(h,d),w||(v=[u(i,"input",e[5]),u(i,"focus",e[6]),u(i,"blur",e[7]),u(d,"click",e[4])],w=!0)},p(t,[e]){2&e&&f(i,"placeholder",t[1]),1&e&&i.value!==t[0]&&g(i,t[0]),4&e&&m(n,"focused",t[2])},i:t,o:t,d(t){t&&c(n),w=!1,o(v)}}}function J(t,e,n){let{placeholder:o=""}=e,{value:i=""}=e,r=!1;const a=t=>{n(2,r=t)};return t.$$set=t=>{"placeholder"in t&&n(1,o=t.placeholder),"value"in t&&n(0,i=t.value)},[i,o,r,a,function(e){y.call(this,t,e)},function(){i=this.value,n(0,i)},()=>{a(!0)},()=>a(!1)]}class W extends z{constructor(t){super(),q(this,t,J,V,r,{placeholder:1,value:0})}}function Z(t){let e,n,o,i,r,h,u;function d(e){t[2](e)}let g={placeholder:"Room ID"};return void 0!==t[0]&&(g.value=t[0]),r=new W({props:g}),$.push((()=>N(r,"value",d))),r.$on("click",t[1]),{c(){e=p(),n=l("section"),o=l("h1"),o.textContent="DropNow",i=p(),D(r.$$.fragment),document.title="DropNow",f(o,"class","svelte-anrdqc"),f(n,"class","svelte-anrdqc")},m(t,c){s(t,e,c),s(t,n,c),a(n,o),a(n,i),I(r,n,null),u=!0},p(t,[e]){const n={};!h&&1&e&&(h=!0,n.value=t[0],R((()=>h=!1))),r.$set(n)},i(t){u||(P(r.$$.fragment,t),u=!0)},o(t){j(r.$$.fragment,t),u=!1},d(t){t&&c(e),t&&c(n),B(r)}}}function F(t,e,n){let o;return[o,()=>M.redirect(`/room/${o}`),function(t){o=t,n(0,o)}]}class Q extends z{constructor(t){super(),q(this,t,F,Z,r,{})}}function X(t,e,n){const o=t.slice();return o[20]=e[n],o}function Y(e){let n,o,i=e[20]+"";return{c(){n=l("p"),o=h(i)},m(t,e){s(t,n,e),a(n,o)},p:t,d(t){t&&c(n)}}}function tt(t){let e,n,r,g,m,w,v,y,b,_,x,k,E,C,L,U,S,T,O,A,H,q,z,G,K,M,V,J,Z,F;function Q(e){t[12](e)}let tt={placeholder:"Send message"};void 0!==t[4]&&(tt.value=t[4]),U=new W({props:tt}),$.push((()=>N(U,"value",Q))),U.$on("click",t[10]);let et=t[8],nt=[];for(let e=0;e<et.length;e+=1)nt[e]=Y(X(t,et,e));return{c(){e=l("main"),n=l("h1"),n.textContent=`Room ${t[7]}`,r=p(),g=l("p"),m=h("ws: "),w=h(t[0]),v=p(),y=l("p"),b=h("rtc: "),_=h(t[1]),x=p(),k=l("p"),E=h("ice: "),C=h(t[2]),L=p(),D(U.$$.fragment),T=p(),O=l("p"),O.textContent="connect",A=p(),H=l("p"),H.textContent=`${t[9]}`,q=p(),z=l("input"),G=p(),K=l("a"),K.textContent="download",M=p(),V=l("div");for(let t=0;t<nt.length;t+=1)nt[t].c();var o,i,a;o="cursor",i="pointer",O.style.setProperty(o,i,a?"important":""),f(z,"type","file"),f(K,"href","/#")},m(o,c){s(o,e,c),a(e,n),a(e,r),a(e,g),a(g,m),a(g,w),a(e,v),a(e,y),a(y,b),a(y,_),a(e,x),a(e,k),a(k,E),a(k,C),a(e,L),I(U,e,null),a(e,T),a(e,O),a(e,A),a(e,H),a(e,q),a(e,z),a(e,G),a(e,K),t[14](K),a(e,M),a(e,V);for(let t=0;t<nt.length;t+=1)nt[t].m(V,null);J=!0,Z||(F=[u(O,"click",(function(){i(t[3])&&t[3].apply(this,arguments)})),u(z,"change",t[13])],Z=!0)},p(e,[n]){t=e,(!J||1&n)&&d(w,t[0]),(!J||2&n)&&d(_,t[1]),(!J||4&n)&&d(C,t[2]);const o={};if(!S&&16&n&&(S=!0,o.value=t[4],R((()=>S=!1))),U.$set(o),256&n){let e;for(et=t[8],e=0;e<et.length;e+=1){const o=X(t,et,e);nt[e]?nt[e].p(o,n):(nt[e]=Y(o),nt[e].c(),nt[e].m(V,null))}for(;e<nt.length;e+=1)nt[e].d(1);nt.length=et.length}},i(t){J||(P(U.$$.fragment,t),J=!0)},o(t){j(U.$$.fragment,t),J=!1},d(n){n&&c(e),B(U),t[14](null),function(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}(nt,n),Z=!1,o(F)}}}function et(t,e,n){let{params:o}=e;const{id:i}=o;let r,a,s,c,l,h=()=>{};(async()=>{const t=window.location.host;let e=new WebSocket(`ws://${t}/ws/${i}`);e.onmessage=t=>v(t.data),e.onclose=()=>n(0,r="closed"),e.onerror=t=>console.log(t),await new Promise(((t,o)=>e.onopen=()=>{n(0,r="connected"),t()})),console.log();a=new RTCPeerConnection({iceServers:[{urls:["stun:stun1.l.google.com:19302","stun:stun2.l.google.com:19302"]}]}),l=a.createDataChannel("dataChan",{negotiated:!0,id:0,ordered:!0}),l.binaryType="arraybuffer";let o=[],p="",u=0;l.onmessage=t=>{if(console.log("recieved:",t.data),"string"==typeof t.data){if(t.data.startsWith("filename:"))p=t.data.slice("filename:".length),o=[],u=0;else if("done"==t.data){const t=new Blob(o);console.log(u),console.log("blog len",t.size),n(6,d.href=URL.createObjectURL(t),d),n(6,d.download=p,d),d.click()}}else u+=t.data.byteLength,o.push(new Blob([t.data]))};const f=t=>null==e?void 0:e.send(JSON.stringify(t));a.onconnectionstatechange=()=>{n(1,s=a.connectionState),"connected"===a.connectionState&&console.log("connected!")},a.onicecandidate=t=>g(t),a.oniceconnectionstatechange=()=>m(),a.onsignalingstatechange=()=>w(),a.onicegatheringstatechange=()=>console.log(a.iceGatheringState),console.log(a);for(let t in a)/^on/.test(t)&&a.addEventListener(t.slice(2),(e=>console.log(t,e)));n(3,h=async()=>{console.log("negotiate");const t=await a.createOffer();await a.setLocalDescription(new RTCSessionDescription(t)),f({type:"sdp",data:t})});const g=t=>{t.candidate&&f({type:"ice-candidate",data:t.candidate})},m=()=>{switch(n(2,c=a.iceConnectionState),a.iceConnectionState){case"closed":case"failed":a.restartIce()}},w=()=>{a.signalingState},v=async t=>{console.log(t);const e=JSON.parse(t);switch(null==e?void 0:e.type){case"sdp":await y(e.data);break;case"ice-candidate":await a.addIceCandidate(e.data)}},y=async t=>{switch(t.type){case"offer":await a.setRemoteDescription(new RTCSessionDescription(t));const e=await a.createAnswer();await a.setLocalDescription(e),f({type:"sdp",data:e});break;case"answer":await a.setRemoteDescription(new RTCSessionDescription(t))}}})();let p;const u=async(t,e,n)=>{l.bufferedAmount>l.bufferedAmountLowThreshold&&await new Promise(((t,e)=>{l.onbufferedamountlow=()=>{l.onbufferedamountlow=null,t()}}));let o=await n.slice(t,e).arrayBuffer();l.send(o)};let f,d;return t.$$set=t=>{"params"in t&&n(11,o=t.params)},[r,s,c,h,p,f,d,i,[],undefined,async()=>{if("open"==(null==l?void 0:l.readyState)){var t=f[0];l.send(`filename:${t.name}`),console.log(t.size);let e=0,o=0;for(;o+16384<=t.size;)o+=16384,await u(e,o,t),e=o;o=t.size,await u(e,o,t),l.send("done"),n(4,p="")}},o,function(t){p=t,n(4,p)},function(){f=this.files,n(5,f)},function(t){$[t?"unshift":"push"]((()=>{d=t,n(6,d)}))}]}class nt extends z{constructor(t){super(),q(this,t,et,tt,r,{params:11})}}function ot(e){let n,o,i;return{c(){n=l("main"),n.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-left svelte-o463b0"><line x1="19" y1="12" x2="5" y2="12"></line><polyline points="12 19 5 12 12 5"></polyline></svg> \n    <h1 class="svelte-o463b0">404</h1>',f(n,"class","svelte-o463b0")},m(t,r){s(t,n,r),o||(i=u(n,"click",e[0]),o=!0)},p:t,i:t,o:t,d(t){t&&c(n),o=!1,i()}}}function it(t){return[()=>M.redirect("/")]}class rt extends z{constructor(t){super(),q(this,t,it,ot,r,{})}}function at(t){let e,n,i;var r=t[0];function a(t){return{props:{params:t[1]}}}return r&&(e=new r(a(t))),{c(){e&&D(e.$$.fragment),n=h("")},m(t,o){e&&I(e,t,o),s(t,n,o),i=!0},p(t,[i]){const s={};if(2&i&&(s.params=t[1]),r!==(r=t[0])){if(e){A={r:0,c:[],p:A};const t=e;j(t.$$.fragment,1,0,(()=>{B(t,1)})),A.r||o(A.c),A=A.p}r?(e=new r(a(t)),D(e.$$.fragment),P(e.$$.fragment,1),I(e,n.parentNode,n)):e=null}else r&&e.$set(s)},i(t){i||(e&&P(e.$$.fragment,t),i=!0)},o(t){e&&j(e.$$.fragment,t),i=!1},d(t){t&&c(n),e&&B(e,t)}}}function st(t,e,n){let o,i;return M("/",(()=>n(0,o=Q))),M("/room/:id",((t,e)=>{n(1,i=t.params),e()}),(()=>n(0,o=nt))),M("*",(()=>n(0,o=rt))),M.start(),[o,i]}return new class extends z{constructor(t){super(),q(this,t,st,at,r,{})}}({target:document.body})}();
//# sourceMappingURL=bundle.js.map
